<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<link rel="stylesheet" href="../STYLE.css">
<body TEXT="#000000" BGCOLOR="#E7E3E7" LINK="#004080" VLINK="#004080" olink="#008080" Background="">
<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><a href="Index11.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index13.html"><img SRC="For.gif" BORDER=0 ></a></td>
  </tr>
</table>

 
<br>
<table width="100%" border="0">
  <tr>
    <td class="Text_n">
 
<p class="Tit_CN">

Журналы консольных сообщений</P>

<p class="Text_n">
Утилита conlog.nlm предоставляет возможность записи консольных сообщений и ошибок, например о выявлении вторжений и блокировании учетных записей. Получив доступ к утилите rconsole, взломщик без проблем может ввести команду unload conlog, отключив режим регистрации сообщений в файле, а затем снова включить этот режим и возобновить запись сообщений в совершенно новый файл console.log. При этом предыдущий файл удаляется, а вместе с ним и все записанные ошибки и сообщения. Грамотный системный администратор должен рассматривать такую ситуацию как попытку взлома. К сожалению, на практике ее иногда относят к разряду необъяснимого.
<br>

Системные ошибки и сообщения, генерируемые в процессе загрузки сервера и выполнения им операций, постоянно регистрируются в файле SYS: SYSTEMX sysSerr.log. Обладая привилегиями администратора, взломщик способен отредактировать этот файл и удалить из него сообщения, связанные с его деятельностью, включая блокирование используемой им учетной записи.
<br>
<P align="center">
<span class="Text_b">Контрмеры против редактирования журналов регистрации</span></P>
<br>
<p class="Text_n">
Следите за изменениями файлов console.log и sysSerr.log. Порекомендовать какие-либо простые способы защиты нельзя. Контролируйте администраторов (или взломщиков), которые знают о том, что решаемая ими задача может оказаться неразрешимой. И проверяйте содержимое файлов журналов в надежде на то, что в них найдут отражение сообщения об отключении системы аудита.
<br>

1. Запустите утилиту SYS: PUBLlCXauditcon.
<br>

2. Выберите команду Audit configuration.
<br>

3. Выберите команду Audit by file/Directory.
<br>

4. Найдите файлы SYS:ETC\console.log и SYS:SYSTEM\sys$err.log.
<br>

5.   Выделите каждый из файлов и нажмите клавишу &lt;F10&gt;, чтобы подключить систему аудита и приступить к записи сообщений.
<br>

6.   Выйдите из утилиты auditcon.
<br>
<P align="center">
<span class="Text_b"> &quot;Потайные ходы&quot;</span></P>
<br>
<p class="Text_n">
Самым эффективным &quot;потайным ходом&quot; системы NetWare является то, чего вы никогда не сможете добиться самостоятельно,— &quot;осиротевшие&quot; объекты (orphaned object). Использование скрытого объекта OU (Organizational Unit), содержащего пользователя с правами, эквивалентными администратору, и правами опекунства на свой собственный контейнер, позволит эффективно скрыть этот объект.
<br>

1.  Зарегистрируйтесь в дереве NDS в качестве администратора или с эквивалентными правами.
<br>

2.   Запустите утилиту NetWare Administrator (nwadmn3x.exe).
<br>

3.   В глубине дерева создайте новый контейнер. Щелкните правой кнопкой на существующем объекте OU и создайте новый объект OU, выбрав команду Create, a затем элемент Organizational Unit.
<br>

4.   Внутри этого контейнера создайте новый объект-пользователь. Щелкните правой кнопкой на новом контейнере, выберите команду Create, а затем — элемент User.
<br>

5.   Предоставьте объекту-пользователю полные права опекунства на его собственный объект. Щелкните правой кнопкой на новом пользователе, и выберите команду Trustees of this Object. Теперь пользователь является явным опекуном.
<br>

6.   Назначьте этому пользователю полные права опекунства на новый контейнер. Щелкните правой кнопкой на новом контейнере и выберите команду Trustees of this Object. Сделайте объект-пользователь явным опекуном нового контейнера, установив все флажки, как показано на следующем рисунке.
<br>

7.   Измените свойства пользователя таким образом, чтобы он получил права, эквивалентные администратору. Щелкните правой кнопкой на объекте-пользователе, выберите в появившемся контекстном меню команду Details, перейдите во вкладку Security Equal To, щелкните на кнопке Add и выберите Admin.
<br>

8.   Модифицируйте фильтр наследуемых прав (inherited rights filter — IRF) контейнера, отменив права Browse и Supervisor.
<br>
<p class="Prim">
При выполнении п. 8 будьте осторожны, поскольку после этого контейнер и созданный объект-пользователь станут невидимыми для всех пользователей, включая Admin. Администраторы не смогут увидеть или удалить этот объект. Сокрытие объекта от администратора оказывается возможным из-за того, что в дереве NDS можно отменить права supervisor для любого объекта или свойства.
</p>

9.  Теперь зарегистрируйтесь с помощью только что созданного &quot;потайного хода&quot;. Не забывайте, что в дереве вы не сможете увидеть новый контейнер. Следовательно, в процессе регистрации потребуется ввести контекст вручную, как видно на следующем рисунке.


<p class="label"><IMG src="20.gif" ><br>
</p>

 <p class="Text_n">
Для получения более подробной информации обратитесь на Web-узел хакерской лаборатории NMRC (Nomad Mobile Research Centre)
(<span class="Text_b">http://www.nmrc.org</span>). Симпл Номад (Simple Nomad) подробно описал эту технологию в разделе Unofficial Hack FAQ по адресу
<span class="Text_b"> http://www.nmrc.org/faqs/hackfaq/ hackfaq.html</span>.
<br>
<P align="center">
<span class="Text_b">
Контрмеры против &quot;потайныхходов&quot;</span></P>
<br>
<p class="Text_n">
Для защиты от подобных нападений можно использовать несколько средств, как свободно распространяемых, так и коммерческих.
<br>

Среди коммерческих программных продуктов можно порекомендовать набор средств администрирования EMS/NOSadmin версии 6
(<span class="Text_b">http://www.bindview.com</span>) от компании BindView. Ее можно использовать для поиска скрытых объектов.
<br>

Из категории свободно распространяемого программного обеспечения заслуживает внимания программа Hidden Object Locator, которую можно найти по адресу
<span class="Text_b">http://www.netwarefiles.com/utils/hobjloc.zip</span>. Эта программа запускается на сервере в качестве модуля NLM и выполняет сканирование дерева NDS на предмет поиска объектов, у которых отсутствуют права просмотра для зарегистрированных пользователей (обычно Admin). Эта программа имеет небольшой размер (87 Кбайт) и абсолютна бесплатна, что делает ее прекрасным решением проблемы скрытых объектов.
<br>

Компания Novell предоставляет лишь один метод решения описанной проблемы — подключение системы аудита. С помощью утилиты SYS:PUBLlC\auditcon можно регистрировать событие Grant Trustee.
<br>

1. Запустите утилиту auditcon.
<br>

2. Выберите команду Audit Directory Services.
<br>

3. Выберите команду Audit Directory Tree.
<br>

4.   Выберите контейнер, для которого нужно подключить систему аудита, и нажмите клавишу &lt;F10&gt;.
<br>

5.   Выберите команду Enable Container Auditing.
<br>

6.   Нажимайте клавишу &lt;Esc&gt; до тех пор, пока не вернетесь в главное меню.
<br>

7.   Выберите команду Enable Volume Auditing.
<br>

8.   Выберите команду Auditing Configuration.
<br>

9.   Выберите Audit By Event.
<br>

10. Выберите Audit By User Events.&nbsp;
<br>

11. Включите режим Grant Trustee.
<br>
 Конечно, предлагаемый метод предполагает, что взломщики не окажутся достаточно умными и перед созданием &quot;потайного хода&quot; не отключат систему аудита.
<br>


</p></td>
  </tr>
</table>
<br>
<table BORDER=0  COLS=3 WIDTH="11%" >
  <tr> 
   <td><a href="Index11.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index13.html"><img SRC="For.gif" BORDER=0 ></a></td>
   
  </tr>
</table>
</body>
</html>
