<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<link rel="stylesheet" href="../STYLE.css">
<body TEXT="#000000" BGCOLOR="#E7E3E7" LINK="#004080" VLINK="#004080" olink="#008080" Background="">
<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><a href="Index12.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index14.html"><img SRC="For.gif" BORDER=0 ></a></td>
  </tr>
</table>

 
<br>
<table width="100%" border="0">
  <tr>
    <td class="Text_n">
 
<p class="Tit_CN">

Virtual Network Computing (VNC)</P>

<p class="Text_n">
Программа Virtual Network Computing разработана в Англии, в лаборатории AT&amp;T Research Labs Кембриджского университета. Ее можно найти по адресу<span class="Text_b"> http://www.uk. research.att.com/vnc</span>. Программа обладает многими уникальными возможностями. Во-первых, ее можно использовать на многих платформах. Этот программный продукт можно устанавливать на компьютеры под управлением системы Windows, Linux и Solaris, а просматривать — в Windows, Linux, Solaris, Macintosh и даже с помощью Windows СЕ. Кроме того, эта программа имеет интерфейс на языке Java, что позволяет ее использовать через такие Java-совместимые броузеры, как Netscape Communicator и Microsoft Internet Explorer. Лучше всего то, что программа VNC является бесплатной!
<br>

Поскольку программа VNC обладает такими богатыми функциональными возможностями, неудивительно, что работа с этим продуктом сопряжена с некоторыми серьезными проблемами, связанными с нарушением безопасности. Она оказывается уязвимой при использовании программы Revelation. Как было показано в главе 5, через удаленное соединение программу VNC можно легко установить в системе Windows NT. Все что для этого требуется, — это инсталлировать службу VNC из командной строки после единственного изменения удаленного системного реестра, что позволит запустить ее в скрытом режиме. Конечно же, независимо от версии в списке Process List все равно будет содержаться процесс winVNC. EXE. Однако важнее всего то, что программа VNC подвержена следующим атакам.
<br>
<ul>
  <li>&nbsp;<span class="Text_b">Прямой подбор паролей VNC</span>.  Ненадежные пароли позволят взломщику получить полный контроль над системой, в которой запущен сервер VNC.</li>
  <li>&nbsp;<span class="Text_b">Перехват сетевого трафика</span>. По умолчанию после аутентификации пользователя сервер VNC не выполняет шифрования данных.</li>
  <li>&nbsp;<span class="Text_b">Ненадежный метод хранения паролей WinVNC</span>. Пароли сервера хранятся в таком виде, что взломщик все равно сможет их восстановить в незашифрованной форме.</li>
</ul>

Ниже каждая из этих атак будет рассмотрена более подробно.
<br>
<P align="center">
<span class="Text_b">
Прямой подбор паролей VNC</span></P>
<br>
<p class="Text_n">
Основным механизмом защиты сервера VNC от несанкционированного доступа является пароль, выбранный системным администратором. В этой книге уже не раз отмечалось, что взлом проще всего осуществить, если используются ненадежные пароли. Поскольку серверу VNC зачастую предоставляются высокие привилегии, решительно настроенный взломщик, проявив определенное упорство, сможет подобрать пароль сервера VNC &quot;в лоб&quot;, простым перебором. Для подбора паролей VNC можно воспользоваться дополнительной программой rfbproto.c
, которую можно применить к клиентскому приложению vncviewer. С помощью команды patch программу rfbproto.c нужно применить к пакету
vnc-3.3.3rl_unixsrc.tgz. В следующем примере демонстрируется, как легко подобрать пароль сервера VNC.
<br>
<p class="Code">
[crush] #  <span class="Text_b">vncviewer  192.168.1.101</span><br>
v'MC server supports protocol version 3.3 (viewer   3.3) <br>
Trying password   '#!comment:' VNC authentication failed<br>
Trying password 'Common'<br>
VNC authentication failed<br>
Trying password 'passwords,'<br>
VNC authentication failed<br>
Trying password 'compiled1<br>
VNC authentication failed<br>
Trying password 'passwd'<br>
VNC authentication failed<br>
Trying password 'test'<br>
VNC authentication succeeded<br>
Desktop name &quot;twistervm&quot;<br>
Connected to VNC server, using protocol version 3.3<br>
</p>

Модифицированный клиент vncviewer быстро перебрал предоставленный список паролей и отгадал пароль test. После этого программа vncviewer соединилась с удаленным сервером и взломщик получил полный контроль над системой. Подобный подбор паролей производится очень быстро, и сервер VNC никак не реагирует на неудачные попытки регистрации.
<br>
<P align="center">
<span class="Text_b">
Контрмеры: защита от подбора паролей VNС</span></P>
<br>
<p class="Text_n">
При настройке сервера VNC важно выбрать надежный пароль. В нем должно содержаться не меньше восьми символов. Пароль не должен быть словом или производной от слова, найденного в словаре. Не забывайте о том, что пароль — это единственная преграда, стоящая между взломщиком и системой. Так что выбирайте его очень внимательно!
<br>
<P align="center">
<span class="Text_b">
Перехват сетевого трафика</span></P>
<br>
<p class="Text_n">
Если пакет VNC установлен без каких бы то ни было модификаций, то после аутентификации шифрование потока сообщений между клиентом и сервером не выполняется. Не стоит надеяться на то, что если этот поток сообщений сжат, то его труднее перехватить, чем, скажем, в сеансе telnet. Поскольку файлы с исходным кодом VNC найти очень легко, то не составит особого труда и разработать специальный перехватчик сообщений VNC. Поэтому установка соединения с сервером VNC без применения шифрования сопряжена с большим риском. Хотя исходный пароль VNC передается с использованием механизма &quot;вопрос/ответ&quot;, весь поток сообщений передается в незашифрованном виде. Вполне возможно, что взломщик сможет отследить передаваемые сообщения и перехватить пароли, вводимые пользователями при регистрации.
<br>
<P align="center">
<span class="Text_b">
Контрмеры: предотвращение перехвата сетевого трафика</span></P>
<br>
<p class="Text_n">
К счастью, существуют различные механизмы, которые можно использовать для шифрования трафика VNC. Первым и основным из них является использование оболочки ssh, с помощью которой можно организовать защищенный канал между клиентом и сервером
VNC. . Кроме того, к исходному коду пакета VNC можно применить дополнительные модули
<span class="Text_b">(http://web.mit.edu/thouis/vnc/</span>), которые позволяют реализовать шифрование по открытому ключу. И наконец, для контроля каждого IP-адреса, с которого происходит доступ, можно использовать ТСР-оболочки
(<span class="Text_b">http://www.uk.research.att.com/vnc/archives/1998-09/0168.html</span>).
<br>
<P align="center">
<span class="Text_b">
Ненадежный метод хранения паролей VNC</span></P>
<br>
<p class="Text_n">
В октябре 1999 года Конд Вампиро (Conde Vampiro) сообщил о некоторых изъянах программы VNC
(<span class="Text_b">http://www.roses-labs.com/advisory/RLvncbug.txt</span>). Самый серьезный недостаток связан с тем, как служба VNC хранит пароль сервера VNC (а именно в системном реестре Windows). Хотя пароль сервера VNC шифруется с помощью алгоритма 3DES, при этом пароль каждый раз сохраняется с использованием фиксированного ключа (23 82 107 6 35 78 88 7). Это еще один наглядный пример неумелого применения надежного алгоритма шифрования (3DES). Поскольку ключ известен, то можно без проблем расшифровать пароль любого сервера VNC.
<br>

Пароль VNC хранится в ключе системного реестра
HKEY_USERSX.DEFAULT\ SOFTWARE\ ORL\WinVNC3\Password. В нашем примере этот ключ представлен следующим блоком данных
<br>

<span class="Text_b">
2F   98   ID   С5   48   ЕО   9Е   С2</span>
<br>

Если сервер, на котором запущена служба VNC, взломан, то для получения пароля VNC можно воспользоваться программой vncdec&nbsp;
(более подробную информацию о взломе систем Windows NT и 2000 можно найти в главах 5 и 6 соответственно). Перед компиляцией исходного файла его нужно немного изменить, чтобы строка паролей выглядела следующим образом.
<br>
<p class="Code">
/*поместите в массив р[] хеш-код пароля*/<br>
char p[]=(Ox2F, 0x98, OxlD, OxC5, 0x48, OxEO, Ox9E, ОхС2};<br>
</p>

После этого можно скомпоновать исполняемый файл vndec, а затем запустить его.
<br>
<p class="Code">
[shadow]# <span class="Text_b">vncdec</span><br>
 test<br>
</p>

Как видно из примера, пароль сервера test без особых усилий можно перевести в незашифрованный текстовый формат.
<br>
<P align="center">
<span class="Text_b">Контрмеры против ненадежного хранения
паролей VNС</span></P>
<br>
<p class="Text_n">
В последней версии программы, доступной во время написания данной книги, этот недостаток все еще не был устранен. Наилучшей зашитой от доступа взломщиков к системному реестру является использование средств обеспечения безопасности на уровне серверов. В главах 5 и 6 приведен исчерпывающий список мер предосторожности систем Windows NT и 2000.
<br>


</p></td>
  </tr>
</table>
<br>
<table BORDER=0  COLS=3 WIDTH="11%" >
  <tr> 
   <td><a href="Index12.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index14.html"><img SRC="For.gif" BORDER=0 ></a></td>
   
  </tr>
</table>
</body>
</html>
