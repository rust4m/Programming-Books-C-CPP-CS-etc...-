<html>
<head>
<meta http-equiv="Content-Language" content="ru">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>
Глава 1
</title>
</head>
<body BGCOLOR="#E7E3E7" TEXT="#000000" LINK="#004080" VLINK="#004080" Background=" ">
<font  face="Verdana, Arial, Helvetica, sans-serif"><table width="14%" border="0" cellspacing="0">
<tr>
<td width="9%">
<font face="Verdana, Arial, Helvetica, sans-serif">
<a href="Index4.htm">
<img src="Back.gif" border="0" width="73" height="22">
</a>
</font>
</td>
<td width="45%">
<font face="Verdana, Arial, Helvetica, sans-serif">
<a href="../index.html">
<img src="Menu.gif" border="0" width="73" height="22">
</a>
</font>
</td>
<td width="46%">
&nbsp;
</td>
</tr>
</table>
<P>
<font face="Verdana, Arial, Helvetica, sans-serif">
&nbsp; 
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="4">
<b>
Клавиатурные шпионы
</font></P>
</b>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Одна из наиболее распространенных разновидностей программных закладок — 
<i>
клавиатурные шпионы. 
</i>
Такие программные закладки нацелены на перехват паролей 
пользователей операционной системы, а также на определение их легальных 
полномочий и прав доступа к компьютерным ресурсам.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Клавиатурные шпионы — явление отнюдь не новое в мире компьютеров. В свое 
время они разрабатывались и для OS/370, и для UNIX, и для DOS. Их поведение в 
общем случае является довольно традиционным: типовой клавиатурный шпион обманным 
путем завладевает пользовательскими паролями, а затем переписывает эти пароли 
туда, откуда их может без особого труда извлечь злоумышленник. Различия между 
клавиатурными шпионами касаются только способа, который применяется ими для 
перехвата пользовательских паролей. Соответственно все клавиатурные шпионы 
делятся на три типа — 
<i>
имитаторы, фильтры и заместители.
</font></p>
</i>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
<b>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Имитаторы
</font></p>
</b>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Клавиатурные шпионы этого типа работают по следующему алгоритму. 
Злоумышленник внедряет в операционную систему программный модуль, который 
имитирует приглашение пользователю зарегистрироваться для того, чтобы войти в 
систему. Затем внедренный модуль (в принятой терминологии — имитатор) переходит 
в режим ожидания ввода пользовательского идентификатора и пароля. После того как 
пользователь идентифицирует себя и введет свой пароль, имитатор сохраняет эти 
данные там, где они доступны злоумышленнику. Далее имитатор инициирует выход из 
системы (что в большинстве случаев можно сделать программным путем), и в 
результате перед глазами у ничего не подозревающего пользователя появляется сто 
одно, но на этот раз уже настоящее приглашение для входа в систему.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Обманутый пользователь, видя, что ему предлагается еще раз внести пароль. 
приходит к выводу о том, что он допустил какую-то ошибку во время предыдущего 
ввода пароля, и послушно повторяет всю процедуру входи в систему заново. 
Некоторые имитаторы для убедительности выдают на экран монитора правдоподобное 
сообщение о якобы совершенной пользователем ошибке. Например, такое: &quot;НЕВЕРНЫЙ 
ПАРОЛЬ. ПОПРОБУЙТЕ ЕЩЕ РАЗ&quot;.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Написание имитатора не требует от его создателя каких-либо особых навыков. 
Злоумышленнику, умеющему программировать на одном из универсальных языков 
программирования (к примеру, на языке BASIC), понадобятся на это считанные часы. 
Единственная трудность, с которой он может столкнуться, состоит в том, чтобы 
отыскать в документации соответствующую программную функцию, реализующую выход 
пользователя из системы.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Перехват пароля зачастую облегчают сами разработчики операционных систем, 
которые не затрудняют себя созданием усложненных по форме приглашений 
пользователю зарегистрироваться для входа в систему. Подобное  
пренебрежительное отношение характерно для большинства версий операционной 
системы UNIX, в которых регистрационное приглашение состоит из двух текстовых 
строк, выдаваемых поочередно на экран терминала:
</font></p>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
<b>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">login: 
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">password:
</font></p>
</b>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Чтобы подделать такое приглашение, не нужно быть семи пядей во лбу. Однако 
само по себе усложнение внешнего вида приглашения не создает для хакера, 
задумавшего внедрить в операционную систему имитатор, каких-либо непреодолимых 
препятствий. Для этого требуется прибегнуть к более сложным и изощренным мерам 
защиты. В качестве примера операционной системы, в которой такие меры в 
достаточно полном объеме реализованы на практике, можно привести Windows NT.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Системный процесс WinLogon, отвечающий в операционной системе Windows NT за 
аутентификацию пользователей, имеет свой собственный рабочий стол — совокупность 
окон, одновременно видимых на экране дисплея. Этот рабочий стол называется 
<i>
столом аутентификации. 
</i>
Никакой другой Процесс, в том числе и имитатор, не 
имеет доступа к рабочему столу аутентификации и не может расположить на нем свое 
окно.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">После запуска Windows NT на экране компьютера возникает так называемое 
начальное окно рабочего стола аутентификации, содержащее указание нажать на 
клавиатуре клавиши &lt;Ctrl&gt;+&lt;Alt&gt;+&lt;Del&gt;. Сообщение о нажатии этих клавиш 
передается только системному процессу WinLogon, а для остальных процессов, в 
частности, для всех прикладных программ, их нажатие происходит совершенно 
незаметно. Далее производится переключение на другое, так называемое 
<i>
регистрационное 
</i>
окно рабочего стола аутентификации. В нем-то как раз и 
размещается приглашение пользователю ввести свое идентификационное имя и пароль, 
которые будут восприняты и проверены процессом WinLogon.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Для перехвата пользовательского пароля внедренный в Windows NT имитатор 
обязательно должен уметь обрабатывать нажатие пользователем клавиш
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
&lt;Ctrl&gt;+&lt;Alt&gt;+&lt;Del&gt;. В противном 
случае произойдет переключение на регистрационное окно рабочего стола 
аутентификации, имитатор станет неактивным и не сможет ничего перехватить, 
поскольку все символы пароля, введенные пользователем, минуют имитатор и станут 
достоянием исключительно системного процесса WinLogon. Как уже говорилось, 
процедура регистрации в Windows NT устроена таким образом, что нажатие клавиш &lt;Ctrl&gt;+&lt;Alt&gt;+&lt;Del&gt; 
проходит бесследно для всех процессов, кроме WinLogon, и поэтому 
пользовательский пароль поступит именно ему.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Конечно, имитатор может попытаться воспроизвести не начальное окно рабочего 
стола аутентификации (в котором высвечивается указание пользователю одновременно 
нажать клавиши &lt;Ctrl&gt;+&lt;Alt&gt;+&lt;Del&gt;), а регистрационное (где содержится 
приглашение ввести идентификационное имя и пароль пользователя). Однако при 
отсутствии имитаторов в системе регистрационное окно автоматически заменяется на 
начальное по прошествии короткого промежутка времени (в зависимости от версии 
Window NT он может продолжаться от 30 с до 1 мин), если в течение этого 
промежутка пользователь не предпринимает никаких попыток зарегистрироваться в 
системе. Таким образом, сам факт слишком долгого присутствия на экране 
регистрационного окна должен насторожить пользователя Windows NT и заставить его 
тщательно проверить свою компьютерную систему на предмет наличия в ней 
программных закладок.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Подводя итог сказанному, можно отметить, что степень защищенности Windows NT 
от имитаторов достаточно высока. Рассмотрение защитных механизмов, реализованных 
в этой операционной системе, позволяет сформулировать два необходимых условия, 
соблюдение которых является обязательным для обеспечения надежной защиты от 
имитаторов:
</font></p>
<ul type="square">
<li>
<font  face="Verdana, Arial, Helvetica, sans-serif">системный процесс, который при входе пользователя в систему получает от 
  него соответствующие регистрационное имя и пароль, должен иметь свой 
  собственный рабочий стол, недоступный другим процессам;
</li>
<li>
переключение на регистрационное окно рабочего стола аутентификации должно 
  происходить абсолютно незаметно для прикладных программ, которые к тому же 
  никак не могут повлиять на это переключение (например, запретить его).
</li>
</ul>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">К сожалению, эти два условия ни в одной из операционных систем, за 
исключением Windows NT, не соблюдаются. Поэтому для повышения их защищенности от 
имитаторов можно порекомендовать воспользоваться административными мерами. 
Например, обязать каждого пользователя немедленно сообщать системному 
администратору, когда вход в систему оказывается невозможен с первого раза, 
несмотря на корректно заданное идентификационное имя и правильно набранный 
пароль.
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
</font></p>
</font>
<b>
<p>
<font face="Verdana, Arial, Helvetica, sans-serif">
Фильтры
</font>
</p>
</b>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<i>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Фильтры 
</i>
&quot;охотятся&quot; за всеми данными, которые пользователь операционной 
системы вводит с клавиатуры компьютера. Самые элементарные фильтры просто 
сбрасывают перехваченный клавиатурный ввод на жесткий диск или в какое-то другое 
место, к которому имеет доступ злоумышленник. Более, изощренные программные 
закладки этого типа подвергают перехваченные данные анализу и отфильтровывают 
информацию, имеющую отношение к пользовательским паролям.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Фильтры являются резидентными программами, перехватывающими одно или 
несколько прерываний, которые связаны с обработкой сигналов от клавиатуры. Эти 
прерывания возвращают информацию о нажатой клавише и введенном символе, которая 
анализируется фильтрами на предмет выявления данных, имеющих отношение к паролю 
пользователя.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Известны несколько фильтров, созданных специально для различных версий 
операционной системы DOS. В 1997 г. отмечено появление фильтров для операционных 
систем Windows 3.11 и Windows 95.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Надо сказать, что изготовить подобного рода программную закладку не 
составляет большого труда. В операционных системах Windows 3.11 и Windows 95/98 
предусмотрен специальный программный механизм, с помощью Которого в них решается 
ряд задач, связанных с получением доступа к вводу с клавиатуры, в том числе и 
проблема поддержки национальных раскладок клавиатур. К примеру, любой 
клавиатурный русификатор для Windows представляет собой самый что ни на есть 
настоящий фильтр, поскольку призван перехватывать все данные, вводимые 
пользователем с клавиатуры компьютера. Нетрудно &quot;доработать&quot; его таким образом, 
чтобы вместе со своей основной функцией (поддержка национальной раскладки 
клавиатуры) он заодно выполнял бы и действия по перехвату паролей. Тем более, 
что но . многих учебных пособиях и руководствах пользователя операционных систем 
Windows имеются исходные тексты программных русификаторов клавиатуры. 
&quot;Перепрофилировав&quot; этот русификатор так, чтобы он взял на себя выполнение 
функций клавиатурного шпиона, его можно встроить перед настоящим русификатором 
или после него, и в результате вся информация. 4 вводимая пользователем с 
клавиатуры, пойдет и через клавиатурного шпиона. Таким образом задача создания 
фильтра становится такой простой, что
<i>
</i>
не требует наличия каких-либо 
специальных знаний у злоумышленника. Ему остается только незаметно внедрить 
изготовленную им программную&nbsp; закладку в операционную систему и умело 
замаскировать ее присутствие.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">В общем случае можно утверждать, что если в операционной системе разрешается 
переключать клавиатурную раскладку во время ввода пароля, то для этой 
операционной системы возможно создание фильтра. Поэтому, чтобы обезопасить ее от 
фильтров, необходимо обеспечить выполнение следующих трех условий:
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
</font></p>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<ul type="square">
<li>
во время ввода пароля переключение раскладок клавиатуры не разрешается ;
</li>
<li>
конфигурировать цепочку программных модулей, участвующих в работе с 
  паролем пользователя, может только системный администратор;
</li>
<li>
доступ к файлам этих модулей имеет исключительно системный администратор.
</li>
</ul>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Соблюсти первое из этих условий в локализованных для России версиях 
операционных систем принципиально невозможно. Дело в том, что средства создания 
учетных пользовательских записей на русском языке являются неотъемлемой частью 
таких систем. Только в англоязычных версиях систем Windows NT и UNIX 
предусмотрены возможности, позволяющие поддерживать уровень безопасности, при 
котором соблюдаются все 3 перечисленные условия.
</font></p>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
<b>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Заместители
</font></p>
</b>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<i>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Заместители 
</i>
полностью или частично подменяют собой программные модули 
операционной системы, отвечающие за аутентификацию пользователей. Подобного рода 
клавиатурные шпионы могут быть созданы для работы в среде практически любой 
многопользовательской операционной системы. Трудоемкость написания заместителя 
определяется сложностью алгоритмов, реализуемых подсистемой аутентификации, и 
интерфейсов между ее отдельными модулями. Также при оценке трудоемкости следует 
принимать во внимание степень документированности этой подсистемы. В целом можно 
сказать, что задача создания заместителя значительно сложнее задачи написания 
имитатора или фильтра. Поэтому фактов использования подобного рода программных 
закладок злоумышленниками пока отмечено не было. Однако в связи с тем, что в 
настоящее время все большее распространение получает операционная система 
Windows NT, имеющая мощные средства защиты от имитаторов и фильтров, в самом 
скором будущем от хакеров следует ожидать более активного использования 
заместителей в целях получения несанкционированного доступа к компьютерным 
системам.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Поскольку заместители берут на себя выполнение функций подсистемы 
аутентификации, перед тем как приступить к перехвату пользовательских паролей 
они должны выполнить следующие действия:
</font></p>
<ul type="square">
<li>
<font  face="Verdana, Arial, Helvetica, sans-serif">подобно компьютерному вирусу внедриться в один или несколько системных 
  файлов;
</li>
<li>
использовать интерфейсные связи между программными модулями полсистемы 
  аутентификации для встраивания себя в цепочку обработки введенного 
  пользователем пароля.
</li>
</ul>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Для того чтобы защитить систему от внедрения заместителя, ее администраторы 
должны строго соблюдать адекватную политику безопасности. И что особенно важно, 
подсистема аутентификации должна быть одним из самых защищенных элементов 
операционной системы. Однако, как показываем практика, администраторы, подобно 
всем людям, склонны к совершению ошибок. А следовательно, соблюдение адекватной 
политики безопасности в течение неограниченного периода времени является 
невыполнимой задачей. Кроме того, как только заместитель попал в компьютерную 
систему, любые меры зашиты от внедрения программных закладок перестают быть 
адекватными, и поэтому необходимо предусмотреть возможность использования 
эффективных средств обнаружения и удаления внедренных клавиатурных шпионов. Это 
значит, что администратор должен вести самый тщательный контроль целостности 
исполняемых системных файлов и интерфейсных функций, используемых подсистемой 
аутентификации для решения своих задач.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Но и эти меры могут оказаться недостаточно эффективными. Ведь машинный код 
заместителя выполняется в контексте операционной системы, и поэтому заместитель 
может предпринимать особые меры, чтобы максимально затруднить собственное 
обнаружение. Например, он может перехватывать системные вызовы, используемые 
администратором для выявления программных закладок, с целью подмены возвращаемой 
ими информации. Или фильтровать сообщения, регистрируемые подсистемой аудита, 
чтобы отсеивать те, которые свидетельствуют о его присутствии в компьютере.
</font></p>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
<b>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Как защитить систему от клавиатурных шпионов
</font></p>
</b>
</font>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Клавиатурные шпионы представляют реальную угрозу безопасности современных 
компьютерных систем. Чтобы отвести эту угрозу, требуется реализовать целый 
комплекс административных мер и программно-аппаратных средств защиты. Надежная 
защита от клавиатурных шпионов может быть построена только тогда, когда 
операционная система обладает определенными возможностями, затрудняющими работу 
клавиатурных шпионов. Они были подробно описаны выше, и не имеет смысла снова на 
них останавливаться.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Однако необходимо еще раз отметить, что единственной операционной системой, в 
которой построение такой защиты возможно, является Windows NT.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Да и то с оговорками, поскольку все равно ее придется снабдить 
дополнительными программными средствами, повышающими степень ее защищенности. В 
частности, в Windows NT необходимо ввести контроль целостности системных файлов 
и интерфейсных связей подсистемы аутентификации.
</font></p>
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">Кроме того, для надежной защиты от клавиатурных шпионов администратор 
операционной системы должен соблюдать политику безопасности, при которой только 
администратор может:
</font></p>
<ul type="square">
<li>
<font  face="Verdana, Arial, Helvetica, sans-serif">&nbsp;конфигурировать цепочки программных модулей, участвующих в процессе 
  аутентификации пользователей;
</li>
<li>
осуществлять доступ к файлам этих программных модулей; 
</li>
<li>
конфигурировать саму подсистему аутентификации.
</font>
</li>
</ul>
<font face="Verdana, Arial, Helvetica, sans-serif" size="3">
<p>
<font  face="Verdana, Arial, Helvetica, sans-serif">И наконец, при организации защиты от клавиатурных шпионов всегда следует 
иметь в виду, что ни неукоснительное соблюдение адекватной политики 
безопасности, ни использование операционной системы, имеющей в своем составе 
средства, существенно затрудняющие внедрение клавиатурных шпионов и облегчающие 
их своевременное обнаружение, ни дополнительная реализация контроля за 
целостностью системных файловой и интерфейсных связей сами по себе не могут 
служить залогом надежной защиты информации в компьютере. Все эти меры должны 
осуществляться в комплексе. Ведь жертвой клавиатурного шпиона может стать любой 
пользователь операционной системы, поскольку ее администраторы тоже люди, время 
от времени и они допускают ошибки в своей работе, а для внедрения клавиатурного 
шпиона достаточно всего одной оплошности администратора.
</font>
<font face="Verdana, Arial, Helvetica, sans-serif">
</font>
</p>
<table width="14%" border="0" cellspacing="0">
<tr>
<td width="9%">
<font face="Verdana, Arial, Helvetica, sans-serif">
<a href="Index4.htm">
<img src="Back.gif" border="0" width="73" height="22">
</a>
</font>
</td>
<td width="45%">
<font face="Verdana, Arial, Helvetica, sans-serif">
<a href="../index.html">
<img src="Menu.gif" border="0" width="73" height="22">
</a>
</font>
</td>
<td width="46%">
&nbsp;
</td>
</tr>
</table>
</body>
</html>
