<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<link rel="stylesheet" href="../STYLE.css">
<body TEXT="#000000" BGCOLOR="#E7E3E7" LINK="#004080" VLINK="#004080" olink="#008080" Background="">
<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><font face="Arial, Helvetica, sans-serif"><a href="Index8.htm"><img SRC="Back.gif"  BORDER=0 ></a></font></td>
    <td WIDTH="10%"><font face="Arial, Helvetica, sans-serif"><a href="Index0.htm"><img SRC="Menu.gif" BORDER=0 ></a></font></td>
    <td ALIGN=RIGHT><font face="Arial, Helvetica, sans-serif"><a href="Index10.htm"><img src="For.gif" width="73" height="22" border="0"></a></font></td>
  </tr>
</table>
<table BORDER =0 COLS=3 WIDTH="11%" >
  <tr> 
    <td WIDTH="10%">&nbsp;</td>
  </tr>
</table>
<table width="100%" border="0">
  <tr> 
    <td class="Text"><p class="tit_A">Автоматизация установки операционной системы </p>
      <p>При установке операционной системы на несколько компьютеров с одина ковой конфигурацией имеет смысл создать и использовать при установке так называемый файл ответов, который будет автоматически подставлять основные параметры, такие как серийный номер, имя пользователя и т. п. Для операционных систем Windows 9 x файл ответом имеет название MSBATCH . INF . Он может быть расположен как в каталоге с дистрибутивом, так и на любом диске, доступном при запуске программы установки. При этом команда запуска установки будет выглядеть следующим образом: </p>
      <p class="Code">A :\ SETUP . EXE A :\ MSBATCH . INF </p>
      <p>Структура этого файла вполне обычная для Windows — это ряд разделов со строго заданными названиями, заключенными в квадратные скобки и внут ри каждого раздела — список параметров (их имена также строго определе ны) со значениями. Необрабатываемые системой комментарии предваряются точкой с запятой. </p>
      <p class="Code">[ Version ] <br>
      signature =&quot;$ CHICAGO $&quot; </p>
      <p>Это обязательный заголовок для INF -файла Windows 9 x , после него следует оставить пустую строку, а уже в следующей строке ввести заголовок первой секции, отвечающей за основные параметры инсталляции ОС: </p>
      <p class="Code">[ Setup ] </p>
      <p>Внутри этого раздела содержится набор параметров, управляющих непо средственно процессом установки системы и эквивалентных ответам на во просы программы SETUP , а также ряд специфических ключей, влияющих на скорость установки ОС, задать которые можно только с помощью файла MSBATCH . INF . Если какой-либо параметр не прописан явным образом, то используется значение по умолчанию. Поскольку мы ставим своей задачей полностью автоматизировать инсталляцию Windows , то прописываем ниже следующие параметры: </p>
      <ul>
        <li class="nonum"> Express = 1 <br>
        Значение 1 — полностью автоматическая установка, программа установки не задает никаких вопросов, значение 0 — полуавтоматическая установка, при которой пользователю разрешается изменять параметры, заданные по умолчанию; </li>
        <li class="nonum"> NoDirWarn = 1 <br>
        Значение 1 — установка операционной системы в имеющуюся папку Windows без предупреждения, значение 0 — подтверждение выбора папки пользователем (по умолчанию);        </li>
        <li class="nonum"> InstallDir = C :\ WINDOWS <br>
        Указывается путь к каталогу, куда будет установлена операционная сис тема, по умолчанию это — C :\ WINDOWS ; </li>
        <li class="nonum">ebd = 0 <br>
        Значение 0 — блокирует создание загрузочной дискеты, значение I — разрешает (по умолчанию); </li>
        <li class="nonum"> ChangeDir = 0 <br>
        Значение 0 — блокирует возможность изменения каталога, в который бу дет установлена Windows (по умолчанию), значение 1 — разрешает; </li>
        <li class="nonum"> OptionalComponents = 1 <br>
          Значение 1 — разрешает произвольный выбор компонентов ОС (по умолчанию), значение 0 — все компоненты определяются типом уста новки системы, диалог выбора компонентов не выводится; </li>
        <li class="nonum"> сср=о <br>
        Значение 0 — блокирует поиск предыдущей версии Windows , значение 1 — поиск будет вестись (по умолчанию); </li>
        <li class="nonum"> CleanBoot = 1 <br>
        Значение 1 — отключает возможность обновления уже существующей на диске версии Windows , производится чистая установка, значение 0 — разрешает обновление (по умолчанию); </li>
        <li class="nonum">Display =0<br>
        Значение 0 — блокирует на время установки вывод на экран любых диа логовых окон, значение 1 — разрешает вывод (по умолчанию); </li>
        <li class="nonum">InstallType =3 <br>
        Указывается тип установки: значение 0 — минимальная, значение 1 — обычная (по умолчанию), значение 2 — на переносной ПК, значение 3 — выборочная; </li>
        <li class="nonum"> DevicePath = 1 <br>
        Значение 1 — разрешает программе установки искать не входящие в состав Windows INF -файлы драйверов устройств в папке с дистрибутивом, это позволяет интефировать все нужные драйверы прямо в дистрибутив, значение 0 — запрещает поиск внешних драйверов (по умолчанию); </li>
        <li class="nonum"> Uninstall = 0 <br>
        Значение 0 — при наличии предыдущей версии Windows в случае обнов ления не будет создаваться архив системных файлов для отмены обнов ления, значение 1 — пользователь выбирает, сохранять возможность уда ления Windows или нет (по умолчанию), 5 — автоматически создается архив; </li>
        <li class="nonum"> ProductKey =&quot; XXXXX - XXXXX - XXXXX - XXXXX - XXXXX &quot; <br>
        CD - Key вашего дистрибутива; </li>
        <li class="nonum"> showEula =0 <br>
        Значение 0 — не выводить лицензионное соглашение, значение 1 — вы водить (по умолчанию); </li>
        <li class="nonum"> TimeZone =&quot; Russian &quot; <br>
        Установка временной зоны; </li>
        <li class="nonum"> NoPrompt 2 Boot = 1 <br>
        Значение 0 — перезагрузка с разрешения пользователя (по умолчанию), значение 1 — перезафузка без запросов к пользователю. </li>
        </ul>      <p>Это основные параметры раздела [ setup ]. Далее следует еще один не менее важный раздел, в котором задаются региональные установки, и для России в нем должны быть следующие параметры: </p>
      <p class="Code">[System] <br>
      MultiLanguage=Cyrillic<br> 
      Locale=L0419 <br>
      SelectedKeyboard=KEYBOARD_00000419 </p>
      <p>Установка указанных параметров обязательна, поскольку полноценную под держку кириллицы в англоязычных версиях Windows можно установить только на этапе инсталляции. Но тут имеется один весьма неприятный нюанс. В любых вариантах Windows 98 и в локализованной русской версии Windows ME проблем с автоматической установкой кириллических парамет ров нет. А вот панъевропейская Windows ME почему-то никак не хочет вос принимать региональные установки из MSBATCH . INF , так что систему та ким способом &quot;обмануть&quot; не удастся. Если вы все-таки являетесь поклонником англоязычных Windows , то возможны два пути решения про блемы: либо никогда не выбирайте полностью автоматическую установку — всегда задавайте параметр Express = o в разделе [ setup ], чтобы иметь воз можность выставить регион и временную зону вручную. Либо разархивируй- те один файл под названием PRECOPY 1. CAB из дистрибутива Windows во временную папку, после чего найдите в ней файлы LOCALE . INF , MULTILNG . INF и CONTENT . INF . В первом из них нужно заменить строки: </p>
      <p class="Code">Default_Locale=&quot;L0409&quot; Resource_Locale=&quot;00000409&quot; </p>
      <p>на </p>
      <p class="Code">Default_Locale=&quot;L0419&quot; Resource_Locale=&quot;00000419&quot; </p>
      <p>Во втором файле — строку </p>
      <p class="Code">De fault_Keyboard=&quot;KEYBOARD_0 0000409&quot;  </p>
      <p>на </p>
      <p class="Code">Default _ Keyboard =&quot; KEYBOARD _00000419&quot; </p>
      <p>И в третьем файле измените строку </p>
      <p class="Code">Default_Content=&quot;244&quot; </p>
      <p>на </p>
      <p class="Code">Default_Content=&quot;203&quot; </p>
      <p>Теперь нужно снова создать файл PRECOPY 1. CAB , но уже с измененными файлами — в этом поможет любой архиватор, способный работать с архива ми CAB . В крайнем случае, просто поместите эти три файла в папку с дист рибутивом Windows — к ним программа установки обратится в первую оче редь вместо архива PRECOPY 1. CAB . В результате во время инсталляции Windows по умолчанию будет выбран регион — &quot;Россия&quot;, после чего с под держкой кириллицы при полностью автоматической установке проблем в дальнейшем не будет. </p>
      <p>В этом же разделе задаются и еще несколько менее интересных установок, например, разрешение экрана, которое будет применяться на завершающей стадии установки: </p>
      <p class="Code">DisplChar =16,1024,768 </p>
      <p>В случае если вы указали выборочную установку без выбора компонентов вруч ную, вам следует обратиться к следующему разделу, который выглядит так: </p>
      <p class="Code">[ OptionalComponents ] </p>
      <p class="Code">&quot; Портфель &quot;=0<br> 
      &quot; Калькулятор &quot;=1<br> 
      &quot; Фоновые рисунки &quot;=0 <br>
      &quot; Игры &quot;=1<br> 
      &quot; Imaging &quot;= l и т . д . </p>
      <p>Как видите, раздел представляет собой обычный список, в котором значе ние 1 говорит о необходимости установки компонента, а значение 0 — на оборот, о том, что данный компонент устанавливать не следует. </p>
      <p>Чтобы программа установки не пыталась установить драйвер для принтера, что весьма характерно для Windows 95, следует создать пустой раздел [ Printers ], который не содержит ни одного параметра. Также следует за дать имя пользователя и название организации: </p>
      <p class="Code">[ NameAndOrg ] <br>
      Name =&quot; Имя пользователя &quot;<br> 
      Оrg =&quot; Название организации &quot;<br> 
      Display =0 </p>
      <p>Параметр Display , точнее его значение, равное 0, блокирует вывод на экран монитора диалогового окна, предлагающего выбрать имя пользователя. 
      </p>
      <p>Вообще этот параметр имеет смысл прописать в каждом разделе, что позволит немного ускорить процесс установки, замедляющийся из-за блокировки мелькания на экране диалоговых окон. Естественно, что существует отдельный раздел для настройки сети: </p>
      <p class="Code">[ Network ] <br>
      ComputerName =&quot; Имя компьютера в сети&quot;<br> 
      Workgroup =&quot; Имя рабочей группы&quot; Description &quot; Notebook &quot; </p>
      <p>Как ни странно это звучит, но компания Microsoft сама предусмотрела воз можность редактирования описываемого файла, поместив специальную программу в каталоге Win 98\ Tools \ Reskit \ Batch на диске с дистрибутивом. В каталоге же Win 98\ Tools \ Reskit \ Infinst имеется еще одна полезная про грамма. Она позволяет включать в дистрибутив драйверы сторонних производителей, интегрируя INF -файл каждого драйвера в файл MSBATCH . INF и копируя необходимые файлы в папку с дистрибутивом Windows . Правда, если драйвер основан не на INF -файле, а является исполняемой програм мой (яркий пример — Detonator ' bi для видеоплат от NVIDIA ), то такой но мер с ним не пройдет — придется запускать его вручную уже после установ ки системы. При работе с этой программой достаточно указать два пути — к папке с файлами драйвера и к папке с дистрибутивом Windows , после чего программа внесет нужные изменения в MSBATCH . INF . Естественно, дист рибутив при этом должен быть на жестком диске, чтобы к нему можно было дописать файлы драйвера. </p>
      <p>Для операционной системы Windows XP файл ответов обычно имеет назва ние UNATTEND . TXT . Для более детального изучения настроек и ручной правки файла ответов читайте файл REF . CHM , который находится в DEPLOY . CAB . Если вы самостоятельно записываете установочный компакт-диск, то переименуйте файл ответов в WINNT . SIF . Для Windows NT /2000 также возможно создание файла ответов, но в этих системах он является мало функциональным. </p>      </td>
  </tr>
</table>
<table BORDER =0 COLS=3 WIDTH="11%" >
  <tr> 
    <td WIDTH="10%">&nbsp;</td>
  </tr>
</table>

<table BORDER=0   COLS=3 WIDTH="16%" >
  <tr> 
    <td><font face="Arial, Helvetica, sans-serif"><a href="Index8.htm"><img SRC="Back.gif"  BORDER=0 ></a></font></td>
    <td WIDTH="10%"><font face="Arial, Helvetica, sans-serif"><a href="Index0.htm"><img SRC="Menu.gif" BORDER=0 ></a></font></td>
    <td ALIGN=RIGHT><font face="Arial, Helvetica, sans-serif"><a href="Index10.htm"><img src="For.gif" width="73" height="22" border="0"></a></font></td>
  </tr>
</table>
</body>
</html>